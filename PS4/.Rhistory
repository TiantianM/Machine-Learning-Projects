train = read.csv("office_train.csv")
test = read.csv("office_test.csv")
head(train)
head(test)
head(train)
View(test)
View(train)
View(train)
library(ggplot2)
library(data.table)
library(ISLR2)
install.packages("ISLR2")
library(ggplot2)
library(data.table)
library(ISLR2)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE, fig.width = 16/2, fig.height = 9/2, tidy.opts=list(width.cutoff=60), tidy=TRUE)
train = na.omit(train)
test = read.csv("office_test.csv")
View(train)
head(train)
View(train)
train1 <- model.matrix(~., data = train)[,-c(2,3)]
head(train1)
train1 <- model.matrix(~., data = train)[,-2]
train1 <- model.matrix(~., data = train)[,-2]
View(train1)
train1 <- model.matrix(~., data = train)[,-1]
head(train1)
train1 <- model.matrix(~., data = train)
train1 <- model.matrix(~., data = train)
head(train1)
View(train1)
library(ggplot2)
library(data.table)
library(ISLR2)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE, fig.width = 16/2, fig.height = 9/2, tidy.opts=list(width.cutoff=60), tidy=TRUE)
train = read.csv("office_train.csv")
test = read.csv("office_test.csv")
head(train)
train1 <- <- model.matrix(~., data = train)[, -1]
train1 <- model.matrix(~., data = train)[, -1]
train1 <- model.matrix(~., data = train)[, -2]
View(train1)
train1 <- model.matrix(~., data = train)
View(train1)
train1 <- model.matrix(~., data = train)
train <= train[,-c(2,3)]
train <- train[,-c(2,3)]
head(train)
train = read.csv("office_train.csv")
test = read.csv("office_test.csv")
train <- train[,-c(2,3)]
head(train)
train = read.csv("office_train.csv")
test = read.csv("office_test.csv")
train <- select(train, -c("episode","episode_name"))
library(ggplot2)
library(glmnet)
library(data.table)
library(dplyr)
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning = FALSE, fig.width = 16/2, fig.height = 9/2, tidy.opts=list(width.cutoff=60), tidy=TRUE)
train = read.csv("office_train.csv")
test = read.csv("office_test.csv")
train <- select(train, -c("episode","episode_name"))
test <- select(test, -c("episode","episode_name"))
train = read.csv("office_train.csv")
test = read.csv("office_test.csv")
train <- select(train, -c("episode","episode_name"))
test <- select(test, -c("episode","episode_name"))
train_du <- model.matrix(~., data=train)[,-1]
train_new <- as.data.frame(train_du)
ols_mod <- lm(imdb_rating~., data=train_new)
summary(ols_mod)
# LOOCV estimate
loocv_ols <- mean(((ols_mod$residuals)/(1 - hatvalues(ols_mod)))^2)
loocv_ols
library('dplyr')
library('tidyverse')
library('glmnet')
df_train <- read_csv('office_train.csv')
df_test <- read_csv('office_test.csv')
#get rid of the features in both data sets that are observation specific
df_train <- df_train %>% select(-starts_with('episode_name'), -starts_with('episode'))
df_test <- df_test %>% select(-starts_with('episode_name'), -starts_with('episode'))
reg = lm(imdb_rating ~ season + andy + angela + darryl + dwight + jim + kelly + kevin + michael + oscar + pam + phyllis + ryan + toby + erin + jan +  ken_kwapis + greg_daniels + b_j_novak +  paul_lieberstein + mindy_kaling + paul_feig + gene_stupnitsky + jennifer_celotta + randall_einhorn + brent_forrester + jeffrey_blitz + justin_spitzer, data = df_train)
#get all parts we need when calculating the formula
coef <- coef(reg)
y_hat <- predict(reg)
y <- df_train$imdb_rating
hii <- hatvalues(reg)
loocv = 0
for (i in (1:nrow(df_train))) {
y_diff = y[i] - y_hat[i]
deno = 1 - hii[i]
loocv = loocv + (y_diff/deno)^2
}
loocv <- loocv/nrow(df_train)
loocv
ols_loocv <- sum(((y-y_hat)/(1-hii))^2) / nrow(df_train)
ols_loocv
train = read.csv("office_train.csv")
test = read.csv("office_test.csv")
train <- select(train, -c("episode","episode_name"))
test <- select(test, -c("episode","episode_name"))
train_du <- model.matrix(~., data=train)[,-1]
train_new <- as.data.frame(train_du)
ols_mod <- lm(imdb_rating~., data=train_new)
summary(ols_mod)
# LOOCV estimate
loocv_ols <- mean(((ols_mod$residuals)/(1 - hatvalues(ols_mod)))^2)
loocv_ols
# new dataframe that have only "important"predictors
train2 <- train_new%>%select(c("seasonSeason 2","seasonSeason 3","seasonSeason 5","seasonSeason 7","jim","kelly","michael","greg_daniels","b_j_novak","paul_lieberstein","mindy_kaling","brent_forrester","justin_spitzer","imdb_rating"))
# compute new LOOCV estimate for smaller model
ols_mod2 <- lm(imdb_rating~., data=train2)
loocv_ols_2 <- mean(((ols_mod2$residuals)/(1 - hatvalues(ols_mod2)))^2)
loocv_ols_2
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
df = read_excel("Book6.xlsx")
View(df)
df = read_excel("Book6.xlsx")
book6 = read_excel("Book6.xlsx")
View(book6)
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
df = read_excel('Book6.xlsx')
View(df)
df = read_excel('2seriesdata.xlsx')
View(df)
df = read.csv("2seriesdata.csv")
df = read.csv("2seriesdata.csv")
library(readxl)
df = read.csv("2seriesdata.xslx")
library(readxl)
df = read.csv("2seriesdata.xslx")
df = read.csv("2seriesdata.xslx")
df = read_excel("2seriesdata.xslx")
df = read_excel("2seriesdata.xslx")
df = read_excel("2seriesdata.xlsx")
View(df)
